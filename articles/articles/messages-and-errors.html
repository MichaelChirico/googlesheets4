<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Messages and errors in googlesheets4 • googlesheets4</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="../../tidyverse.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><link href="../../tidyverse-2.css" rel="stylesheet">
<!--optional theme--><link href="../../.css" rel="stylesheet">
<meta property="og:title" content="Messages and errors in googlesheets4">
<meta property="og:description" content="googlesheets4">
<meta property="og:image" content="https://googlesheets4.tidyverse.org/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115082821-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="../../index.html">googlesheets4</a>
        <div class="info hidden-xs hidden-sm">
          <span class="partof">part of the <a href="https://tidyverse.org">tidyverse</a></span>
          <span class="version version-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0.9000</span>
        </div>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
<li>
  <a href="../../articles/googlesheets4.html">Get started</a>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/articles/read-sheets.html">Read Sheets</a>
    </li>
    <li>
      <a href="../../articles/articles/write-sheets.html">Write Sheets</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Special topics</li>
    <li>
      <a href="../../articles/articles/auth.html">googlesheets4 auth</a>
    </li>
    <li>
      <a href="../../articles/articles/dates-and-times.html">Dates and times</a>
    </li>
    <li>
      <a href="../../articles/articles/find-identify-sheets.html">Find and identify Sheets</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Connections to other packages</li>
    <li>
      <a href="../../articles/articles/drive-and-sheets.html">Using googlesheets4 with googledrive</a>
    </li>
    <li>
      <a href="../../articles/articles/fun-with-googledrive-and-readxl.html">Fun with googledrive and readxl</a>
    </li>
    <li>
      <a href="../../articles/articles/googlesheets4-reprex.html">How to create a googlesheets4 reprex</a>
    </li>
    <li class="divider">
    <li>
      <a href="../../articles/index.html">More...</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Blog posts</li>
    <li>
      <a href="https://www.tidyverse.org/blog/2020/05/googlesheets4-0-2-0/">googlesheets4 0.2.0</a>
    </li>
    <li class="divider">
    <li>
      <a href="../../news/index.html">Change log</a>
    </li>
  </ul>
</li>
        <li>
  <a href="https://github.com/tidyverse/googlesheets4/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="messages-and-errors_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Messages and errors in googlesheets4</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tidyverse/googlesheets4/blob/master/vignettes/articles/messages-and-errors.Rmd"><code>vignettes/articles/messages-and-errors.Rmd</code></a></small>
      <div class="hidden name"><code>messages-and-errors.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://googlesheets4.tidyverse.org">googlesheets4</a></span><span class="op">)</span></code></pre></div>
<p><em>In a hidden chunk here, I “export” the internal helpers covered below.</em></p>
<div id="user-facing-messages" class="section level2">
<h2 class="hasAnchor">
<a href="#user-facing-messages" class="anchor"></a>User-facing messages</h2>
<p>Everything should be emitted by helpers in <code>utils-ui.R</code>: specifically, <code>gs4_bullets()</code> (and, for errors, <code>gs4_abort()</code>). These helpers are all wrappers around cli functions, such as <code><a href="https://cli.r-lib.org/reference/cli_bullets.html">cli::cli_bullets()</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gs4_bullets</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
        <span class="st">"noindent"</span>,
  <span class="st">" "</span> <span class="op">=</span> <span class="st">"indent"</span>,
  <span class="st">"*"</span> <span class="op">=</span> <span class="st">"bullet"</span>,
  <span class="st">"&gt;"</span> <span class="op">=</span> <span class="st">"arrow"</span>,
  <span class="st">"v"</span> <span class="op">=</span> <span class="st">"Doing good stuff for YOU the user"</span>,
  <span class="st">"x"</span> <span class="op">=</span> <span class="st">"Nope nope nope"</span>,
  <span class="st">"!"</span> <span class="op">=</span> <span class="st">"You might want to know about this"</span>,
  <span class="st">"i"</span> <span class="op">=</span> <span class="st">"The more you know!"</span>
<span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; noindent</span>
<span class="co">#&gt;   indent</span>
<span class="co">#&gt; • bullet</span>
<span class="co">#&gt; → arrow</span>
<span class="co">#&gt; ✔ Doing good stuff for YOU the user</span>
<span class="co">#&gt; ✖ Nope nope nope</span>
<span class="co">#&gt; ! You might want to know about this</span>
<span class="co">#&gt; ℹ The more you know!</span></code></pre></div>
<p>The helpers encourage consistent styling and make it possible to selectively silence messages coming from googlesheets4. The googlesheets4 message helpers:</p>
<ul>
<li>Use the <a href="https://cli.r-lib.org/index.html">cli package</a> to get interpolation, inline markup, and pluralization</li>
<li>Eventually route through <code><a href="https://rlang.r-lib.org/reference/abort.html">rlang::inform()</a></code>, which is important because <code>inform()</code> prints to standard output in interactive sessions. This means that informational messages won’t have the same “look” as errors and can generally be more stylish, at least in IDEs like RStudio.</li>
<li>Are under the control of the <code>GOOGLESHEETS4_QUIET</code> environment variable. If it’s unset, the default is to show messages (unless we’re testing, i.e. the environment variable <code>TESTTHAT</code> is <code>"true"</code>). <code>GOOGLESHEETS4_QUIET=true</code> will suppress messages. There are withr-style convenience helpers: <code><a href="../../reference/googlesheets4-configuration.html">local_gs4_quiet()</a></code> and <code><a href="../../reference/googlesheets4-configuration.html">with_gs4_quiet()</a></code>.</li>
</ul>
<div id="inline-styling" class="section level3">
<h3 class="hasAnchor">
<a href="#inline-styling" class="anchor"></a>Inline styling</h3>
<p>How we use the inline classes:</p>
<ul>
<li>
<code>.file</code> for the name of Google Sheet</li>
<li>
<code>.field</code> for the name of a worksheet</li>
<li>
<code>.field</code> for an A1-style range or named range</li>
<li>
<code>.url</code> and <code>.email</code> for a URL or email address</li>
</ul>
<p><em>These may not demo well via pkgdown, but the interactive experience is nice.</em></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nm</span> <span class="op">&lt;-</span> <span class="st">"name-of-a-Google-Sheet"</span>
<span class="fu">gs4_bullets</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>v <span class="op">=</span> <span class="st">"Creating new Sheet: {.file {nm}}"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; ✔ Creating new Sheet: 'name-of-a-Google-Sheet'</span>

<span class="va">nm</span> <span class="op">&lt;-</span> <span class="st">"name-of-a-worksheet"</span>
<span class="fu">gs4_bullets</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>v <span class="op">=</span> <span class="st">"Protecting cells on sheet: {.field {nm}}"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; ✔ Protecting cells on sheet: name-of-a-worksheet</span>

<span class="va">rg</span> <span class="op">&lt;-</span> <span class="st">"A3:B20"</span>
<span class="fu">gs4_bullets</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>v <span class="op">=</span> <span class="st">"Writing to the range {.field {rg}}"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; ✔ Writing to the range A3:B20</span></code></pre></div>
<p>Most relevant cli docs:</p>
<ul>
<li><a href="https://cli.r-lib.org/reference/inline-markup.html">CLI inline markup</a></li>
<li><a href="https://cli.r-lib.org/articles/semantic-cli.html">Building a Semantic CLI</a></li>
</ul>
</div>
<div id="pluralization" class="section level3">
<h3 class="hasAnchor">
<a href="#pluralization" class="anchor"></a>Pluralization</h3>
<p><a href="https://cli.r-lib.org/articles/pluralization.html">cli’s pluralization</a> is awesome!</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nm</span> <span class="op">&lt;-</span> <span class="st">"name-of-a-Google-Sheet"</span>
<span class="va">n_new</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="fu">gs4_bullets</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>v <span class="op">=</span> <span class="st">"Adding {n_new} sheet{?s} to {.file {nm}}"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; ✔ Adding 1 sheet to 'name-of-a-Google-Sheet'</span>

<span class="va">n_new</span> <span class="op">&lt;-</span> <span class="fl">3</span>
<span class="fu">gs4_bullets</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>v <span class="op">=</span> <span class="st">"Adding {n_new} sheet{?s} to {.file {nm}}"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; ✔ Adding 3 sheets to 'name-of-a-Google-Sheet'</span></code></pre></div>
</div>
<div id="collapsing" class="section level3">
<h3 class="hasAnchor">
<a href="#collapsing" class="anchor"></a>Collapsing</h3>
<p><a href="https://cli.r-lib.org/articles/semantic-cli.html#inline-lists-of-items">Collapsing lists of things</a> is great! Also more pluralization.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">new_sheet_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"apple"</span>, <span class="st">"banana"</span>, <span class="st">"cherry"</span><span class="op">)</span>
<span class="fu">gs4_bullets</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"New sheet{?s}: {.field {new_sheet_names}}"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; New sheets: apple, banana, and cherry</span>

<span class="va">new_sheet_names</span> <span class="op">&lt;-</span> <span class="st">"kumquat"</span>
<span class="fu">gs4_bullets</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"New sheet{?s}: {.field {new_sheet_names}}"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; New sheet: kumquat</span></code></pre></div>
</div>
<div id="tricky-stuff" class="section level3">
<h3 class="hasAnchor">
<a href="#tricky-stuff" class="anchor"></a>Tricky stuff</h3>
<p>If you want to see some tricky examples of building up a message from parts, look here:</p>
<ul>
<li><code><a href="../../reference/range_speedread.html">range_speedread()</a></code></li>
</ul>
</div>
</div>
<div id="errors" class="section level2">
<h2 class="hasAnchor">
<a href="#errors" class="anchor"></a>Errors</h2>
<p>Use <code>gs4_abort()</code> instead of <code><a href="https://rlang.r-lib.org/reference/abort.html">rlang::abort()</a></code> or <code><a href="https://rdrr.io/r/base/stop.html">stop()</a></code>. So far, I’m not really using <code>...</code> to put data in the condition, but I could start when/if there’s a reason to. Be prepared to get confused about how to style and line break error messages vs. regular messages, which use <code><a href="https://glue.tidyverse.org/reference/glue.html">glue::glue()</a></code> and <code><a href="https://cli.r-lib.org/reference/cli_alert.html">cli::cli_alert()</a></code>, respectively.</p>
<p><code>abort_unsupported_conversion()</code> is a wrapper around <code>gs4_abort()</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/structure.html">structure</a></span><span class="op">(</span><span class="fl">1</span>, class <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span><span class="op">)</span><span class="op">)</span>
<span class="fu">abort_unsupported_conversion</span><span class="op">(</span><span class="va">x</span>, to <span class="op">=</span> <span class="st">"foofy"</span><span class="op">)</span>
<span class="co">#&gt; Error: Don't know how to make an instance of &lt;character&gt; from something of class &lt;a/b/c&gt;</span></code></pre></div>
<p><code>abort_unsupported_conversion()</code> exists to standardize a recurring type of error message, usually encountered during development, not by end-users. I use it a lot in the default method of an <code>as_{to}()</code> generic.</p>
<div id="inline-styling-1" class="section level3">
<h3 class="hasAnchor">
<a href="#inline-styling-1" class="anchor"></a>Inline styling</h3>
<p>We process the <code>message</code> of <code>gs4_abort()</code> with <code><a href="https://glue.tidyverse.org/reference/glue.html">glue::glue()</a></code>.</p>
<p>Use helpers <code>dq()</code>, <code>sq()</code>, and <code>bt()</code> for inline style (yes, it’s clunky compared to cli):</p>
<ul>
<li>
<code>dq()</code> for double quotes (Sheet names)</li>
<li>
<code>sq()</code> for single quotes (worksheet names, ranges, and most strings, generally)</li>
<li>
<code>bt()</code> for backticks (argument names, functions)</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nm</span> <span class="op">&lt;-</span> <span class="st">"name-of-a-Google-Sheet"</span>
<span class="fu">gs4_abort</span><span class="op">(</span><span class="st">"Use double quotes around a Google Sheet name: {dq(nm)}"</span><span class="op">)</span>
<span class="co">#&gt; Error: Use double quotes around a Google Sheet name: "name-of-a-Google-Sheet"</span>

<span class="va">nm</span> <span class="op">&lt;-</span> <span class="st">"name-of-a-worksheet"</span>
<span class="fu">gs4_abort</span><span class="op">(</span><span class="st">"Use single quotes around a worksheet name: {sq(nm)}"</span><span class="op">)</span>
<span class="co">#&gt; Error: Use single quotes around a worksheet name: 'name-of-a-worksheet'</span>

<span class="fu">gs4_abort</span><span class="op">(</span><span class="st">"In fact, when in doubt, just use single quotes around {sq('stuff')}"</span><span class="op">)</span>
<span class="co">#&gt; Error: In fact, when in doubt, just use single quotes around 'stuff'</span>

<span class="fu">gs4_abort</span><span class="op">(</span><span class="st">"
  But use backticks when referring to an {bt('argument')} \\
  or {bt('function()')}"</span><span class="op">)</span>
<span class="co">#&gt; Error: But use backticks when referring to an `argument` or `function()`</span></code></pre></div>
</div>
<div id="multiple-lines-and-bullets" class="section level3">
<h3 class="hasAnchor">
<a href="#multiple-lines-and-bullets" class="anchor"></a>Multiple lines and bullets</h3>
<p>Get multiple lines by sending a character vector as <code>message</code>. Think about what <code><a href="https://rlang.r-lib.org/reference/format_error_bullets.html">rlang::format_error_bullets()</a></code> does and be intentional with naming: the choices are <code>i</code>, <code>x</code>, and no name.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bad_stuff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"eew"</span>, <span class="st">"yuck"</span>, <span class="st">"uh-oh"</span><span class="op">)</span>
<span class="fu">gs4_abort</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
  <span class="st">"This first line is a header, explaining the general situation"</span>,
  x <span class="op">=</span> <span class="st">"Sometimes you have to deliver Very Bad News"</span>,
  <span class="va">bad_stuff</span>,
  i <span class="op">=</span> <span class="st">"Maybe a call to {bt('magic_function()')} would help?"</span>
<span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Error: This first line is a header, explaining the general situation</span>
<span class="co">#&gt; ✖ Sometimes you have to deliver Very Bad News</span>
<span class="co">#&gt; eew</span>
<span class="co">#&gt; yuck</span>
<span class="co">#&gt; uh-oh</span>
<span class="co">#&gt; ℹ Maybe a call to `magic_function()` would help?</span>

<span class="va">endpoint</span> <span class="op">&lt;-</span> <span class="st">"sheets.spreadsheets.WTF"</span>
<span class="fu">gs4_abort</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Endpoint not recognized:"</span>, x <span class="op">=</span> <span class="st">"{sq(endpoint)}"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Error: Endpoint not recognized:</span>
<span class="co">#&gt; ✖ 'sheets.spreadsheets.WTF'</span></code></pre></div>
</div>
<div id="line-breaks-and-whitespace" class="section level3">
<h3 class="hasAnchor">
<a href="#line-breaks-and-whitespace" class="anchor"></a>Line breaks and whitespace</h3>
<p>Remember each element of <code>message</code> is processed with <code><a href="https://glue.tidyverse.org/reference/glue.html">glue::glue()</a></code>, so let’s review the line break situation, which is different to the messages made with cli, which is confusing.</p>
<p>This produces two lines:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shift</span> <span class="op">&lt;-</span> <span class="st">"SHIFT"</span>
<span class="fu">gs4_abort</span><span class="op">(</span><span class="st">"
  The {bt('shift')} direction must be specified for this {bt('range')}
  It can't be automatically determined"</span><span class="op">)</span>
<span class="co">#&gt; Error: The `shift` direction must be specified for this `range`</span>
<span class="co">#&gt; It can't be automatically determined</span></code></pre></div>
<p>Use <code>\\</code> if you want continuation, i.e. you want one line:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shift</span> <span class="op">&lt;-</span> <span class="st">"SHIFT"</span>
<span class="fu">gs4_abort</span><span class="op">(</span><span class="st">"
  The {bt('shift')} direction must be specified for this {bt('range')}. \\
  It can't be automatically determined."</span><span class="op">)</span>
<span class="co">#&gt; Error: The `shift` direction must be specified for this `range`. It can't be automatically determined.</span>

<span class="va">very_very_very_very_very_very_very_very_long_variable_name</span> <span class="op">&lt;-</span> <span class="st">"HA HA"</span>
<span class="fu">gs4_abort</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
  <span class="st">"Imagine {very_very_very_very_very_very_very_very_long_variable_name} \\
   a line that's long in source but short after interpolation"</span>, 
  x <span class="op">=</span> <span class="st">"Short bad thing"</span>,
  i <span class="op">=</span> <span class="st">"Helpful tip"</span>
<span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Error: Imagine HA HA a line that's long in source but short after interpolation</span>
<span class="co">#&gt; ✖ Short bad thing</span>
<span class="co">#&gt; ℹ Helpful tip</span></code></pre></div>
</div>
<div id="pluralization-1" class="section level3">
<h3 class="hasAnchor">
<a href="#pluralization-1" class="anchor"></a>Pluralization</h3>
<p>Use <code><a href="https://cli.r-lib.org/reference/pluralize.html">cli::pluralize()</a></code> directly if you need pluralization in error messages. Search for <code><a href="https://cli.r-lib.org/reference/pluralization-helpers.html">cli::qty()</a></code> for a few places where the pluralization was a bit trickier.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">col_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"apple"</span>, <span class="st">"banana"</span><span class="op">)</span>
<span class="va">nc</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="fu">gs4_abort</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
  <span class="st">"Length of {bt('col_names')} is not compatible with the data:"</span>,
  x <span class="op">=</span> <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/pluralize.html">pluralize</a></span><span class="op">(</span><span class="st">"Expected {length(col_names)} un-skipped column{?s}"</span><span class="op">)</span>,
  x <span class="op">=</span> <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/pluralize.html">pluralize</a></span><span class="op">(</span><span class="st">"But data has {nc} column{?s}"</span><span class="op">)</span>
<span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Error: Length of `col_names` is not compatible with the data:</span>
<span class="co">#&gt; ✖ Expected 2 un-skipped columns</span>
<span class="co">#&gt; ✖ But data has 1 column</span>

<span class="va">m</span> <span class="op">&lt;-</span> <span class="fl">8</span>
<span class="va">sheets_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span>
<span class="fu">gs4_abort</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
  <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/pluralize.html">pluralize</a></span><span class="op">(</span><span class="st">"There {?is/are} {nrow(sheets_df)} sheet{?s}:"</span><span class="op">)</span>,
  x <span class="op">=</span> <span class="st">"Requested sheet number is out-of-bounds: {m}"</span>
<span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Error: There are 6 sheets:</span>
<span class="co">#&gt; ✖ Requested sheet number is out-of-bounds: 8</span>

<span class="va">sheets_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fl">1</span><span class="op">)</span>
<span class="fu">gs4_abort</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
  <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/pluralize.html">pluralize</a></span><span class="op">(</span><span class="st">"There {?is/are} {nrow(sheets_df)} sheet{?s}:"</span><span class="op">)</span>,
  x <span class="op">=</span> <span class="st">"Requested sheet number is out-of-bounds: {m}"</span>
<span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Error: There is 1 sheet:</span>
<span class="co">#&gt; ✖ Requested sheet number is out-of-bounds: 8</span></code></pre></div>
</div>
<div id="collapsing-1" class="section level3">
<h3 class="hasAnchor">
<a href="#collapsing-1" class="anchor"></a>Collapsing</h3>
<p>Use <code><a href="https://glue.tidyverse.org/reference/glue_collapse.html">glue::glue_collapse()</a></code> ahead of time, if you need to style and collapse.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bad_codes</span> <span class="op">&lt;-</span> <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>
<span class="va">bad_codes</span> <span class="op">&lt;-</span> <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue_collapse.html">glue_collapse</a></span><span class="op">(</span><span class="fu">sq</span><span class="op">(</span><span class="va">bad_codes</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">","</span><span class="op">)</span>
<span class="fu">gs4_abort</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
  <span class="st">"{bt('col_types')} must be a string of readr-style shortcodes:"</span>,
  x <span class="op">=</span> <span class="st">"Unrecognized codes: {bad_codes}"</span>
<span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Error: `col_types` must be a string of readr-style shortcodes:</span>
<span class="co">#&gt; ✖ Unrecognized codes: 'a','b','c'</span></code></pre></div>
</div>
<div id="tricky-stuff-1" class="section level3">
<h3 class="hasAnchor">
<a href="#tricky-stuff-1" class="anchor"></a>Tricky stuff</h3>
<p>If you want to see some tricky examples of building up a message from parts, look here:</p>
<ul>
<li>
<code>rep_ctypes()</code> (conditional pluralization)</li>
</ul>
</div>
</div>
<div id="future-thoughts" class="section level2">
<h2 class="hasAnchor">
<a href="#future-thoughts" class="anchor"></a>Future thoughts</h2>
<p>Would I ever want to use cli in the errors? There are good things and bad things about that. Messing around. This may very well not show up in pkgdown, which is related to what’s problematic.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/abort.html">abort</a></span><span class="op">(</span><span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/ansi-styles.html">col_blue</a></span><span class="op">(</span><span class="st">"Hello "</span>, <span class="st">"world!"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Error: Hello world!</span>

<span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/abort.html">abort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"... to highlight the"</span>, <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/ansi-styles.html">col_red</a></span><span class="op">(</span><span class="st">"search term"</span><span class="op">)</span>,
                   <span class="st">"in a block of text\n"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Error: ... to highlight the search term in a block of text</span>

<span class="va">error</span> <span class="op">&lt;-</span> <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/combine_ansi_styles.html">combine_ansi_styles</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"bold"</span><span class="op">)</span>
<span class="va">warn</span> <span class="op">&lt;-</span> <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/combine_ansi_styles.html">combine_ansi_styles</a></span><span class="op">(</span><span class="st">"magenta"</span>, <span class="st">"underline"</span><span class="op">)</span>
<span class="va">note</span> <span class="op">&lt;-</span> <span class="fu">cli</span><span class="fu">::</span><span class="va"><a href="https://cli.r-lib.org/reference/ansi-styles.html">style_italic</a></span>

<span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/abort.html">abort</a></span><span class="op">(</span><span class="fu">error</span><span class="op">(</span><span class="st">"Error: subscript out of bounds!\n"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Error: Error: subscript out of bounds!</span>
<span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/abort.html">abort</a></span><span class="op">(</span><span class="fu">warn</span><span class="op">(</span><span class="st">"Warning: shorter argument was recycled.\n"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Error: Warning: shorter argument was recycled.</span>
<span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/abort.html">abort</a></span><span class="op">(</span><span class="fu">note</span><span class="op">(</span><span class="st">"Note: no such directory.\n"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Error: Note: no such directory.</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="tidyverse">
  <p>googlesheets4 is a part of the <strong>tidyverse</strong>, an ecosystem of packages designed with common APIs and a shared philosophy. Learn more at <a href="https://tidyverse.org">tidyverse.org</a>.</p>
</div>

<div class="author">
  <p>
    Developed by <a href="https://jennybryan.org">Jennifer Bryan</a>, <a href="https://www.rstudio.com"><img src="https://www.tidyverse.org/rstudio-logo.svg" alt="RStudio" height="24"></a>.
    Site built by <a href="https://pkgdown.r-lib.org">pkgdown</a>.
  </p>
</div>

      </footer>
</div>

  


  </body>
</html>
